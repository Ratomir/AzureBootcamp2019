{"tasks":[{"environment":{},"displayName":"Set firewall rule","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"$(connection)","ScriptType":"FilePath","ScriptPath":"$(System.DefaultWorkingDirectory)/HelpFiles/scripts/SetAzureFirewallRule.ps1","Inline":"# You can write your azure powershell scripts inline here. \n# You can also pass predefined and custom variables to this script using arguments","ScriptArguments":"-ResourceGroup $(resource-group) -ServerName $(short-sqlservername)","errorActionPreference":"stop","FailOnStandardError":"false","TargetAzurePs":"LatestVersion","CustomTargetAzurePs":"5.1.1"},"task":{"id":"72a1931b-effb-4d2e-8fd8-f8472a07cb62","versionSpec":"3.*","definitionType":"task"}},{"environment":{},"displayName":"Azure CLI create database","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"connectedServiceNameARM":"$(connection)","scriptType":"ps","scriptLocation":"scriptPath","scriptPath":"HelpFiles/scripts/createDatabase.ps1","inlineScript":"","scriptArguments":"-dbname $(sqlserverdatabase) -resourcegroup $(resource-group) -server $(short-sqlservername) -serverfullname $(sqlservername)","powerShellErrorActionPreference":"stop","addSpnToEnvironment":"false","useGlobalConfig":"false","cwd":"","failOnStandardError":"false","powerShellIgnoreLASTEXITCODE":"false"},"task":{"id":"46e4be58-730b-4389-8a2f-ea10b3e5e815","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Edition up for sql server","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"$(connection)","ScriptType":"FilePath","ScriptPath":"$(System.DefaultWorkingDirectory)/HelpFiles/scripts/boostServerEdition.ps1","Inline":"# You can write your azure powershell scripts inline here. \n# You can also pass predefined and custom variables to this script using arguments","ScriptArguments":"-sqlServerResourceGroupName $(resource-group) -serverName $(short-sqlservername) -databaseName $(sqlserverdatabase) -edition 'Standard' -serviceObjectiveName 'S3'","errorActionPreference":"stop","FailOnStandardError":"false","TargetAzurePs":"OtherVersion","CustomTargetAzurePs":"5.1.1"},"task":{"id":"72a1931b-effb-4d2e-8fd8-f8472a07cb62","versionSpec":"3.*","definitionType":"task"}},{"environment":{},"displayName":"Diff report","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"$(connection)","AuthenticationType":"server","ServerName":"$(sqlservername)","DatabaseName":"$(sqlserverdatabase)","SqlUsername":"$(sqlserverusername)","SqlPassword":"$(sqlserverpassword)","aadSqlUsername":"","aadSqlPassword":"","ConnectionString":"","TaskNameSelector":"DacpacTask","DeploymentAction":"DriftReport","DacpacFile":"$(dir)/db/SqlServerDatabaseProject.dacpac","BacpacFile":"","SqlFile":"","SqlInline":"","PublishProfile":"","AdditionalArguments":"/mp:9","SqlAdditionalArguments":"","InlineAdditionalArguments":"","IpDetectionMethod":"AutoDetect","StartIpAddress":"","EndIpAddress":"","DeleteFirewallRule":"true"},"task":{"id":"ce85a08b-a538-4d2b-8589-1d37a9ab970f","versionSpec":"1.*","definitionType":"task"}},{"environment":{},"displayName":"Copy diff report","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"SourceFolder":"GeneratedOutputFiles","Contents":"**","TargetFolder":"GeneratedOutputFilesBlob","CleanTargetFolder":"true","OverWrite":"true","flattenFolders":"true","preserveTimestamp":"false"},"task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Publish report","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"$(connection)","AuthenticationType":"server","ServerName":"$(sqlservername)","DatabaseName":"$(sqlserverdatabase)","SqlUsername":"$(sqlserverusername)","SqlPassword":"$(sqlserverpassword)","aadSqlUsername":"","aadSqlPassword":"","ConnectionString":"","TaskNameSelector":"DacpacTask","DeploymentAction":"DeployReport","DacpacFile":"$(dir)/db/SqlServerDatabaseProject.dacpac","BacpacFile":"","SqlFile":"","SqlInline":"","PublishProfile":"","AdditionalArguments":"/mp:9","SqlAdditionalArguments":"","InlineAdditionalArguments":"","IpDetectionMethod":"AutoDetect","StartIpAddress":"","EndIpAddress":"","DeleteFirewallRule":"true"},"task":{"id":"ce85a08b-a538-4d2b-8589-1d37a9ab970f","versionSpec":"1.*","definitionType":"task"}},{"environment":{},"displayName":"Copy publish report","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"SourceFolder":"GeneratedOutputFiles","Contents":"**","TargetFolder":"GeneratedOutputFilesBlob","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false","preserveTimestamp":"false"},"task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Generate script","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"$(connection)","AuthenticationType":"server","ServerName":"$(sqlservername)","DatabaseName":"$(sqlserverdatabase)","SqlUsername":"$(sqlserverusername)","SqlPassword":"$(sqlserverpassword)","aadSqlUsername":"","aadSqlPassword":"","ConnectionString":"","TaskNameSelector":"DacpacTask","DeploymentAction":"Script","DacpacFile":"$(dir)/db/SqlServerDatabaseProject.dacpac","BacpacFile":"","SqlFile":"","SqlInline":"","PublishProfile":"","AdditionalArguments":"/mp:9","SqlAdditionalArguments":"","InlineAdditionalArguments":"","IpDetectionMethod":"AutoDetect","StartIpAddress":"","EndIpAddress":"","DeleteFirewallRule":"true"},"task":{"id":"ce85a08b-a538-4d2b-8589-1d37a9ab970f","versionSpec":"1.*","definitionType":"task"}},{"environment":{},"displayName":"Copy generated script","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"SourceFolder":"GeneratedOutputFiles","Contents":"**","TargetFolder":"GeneratedOutputFilesBlob","CleanTargetFolder":"false","OverWrite":"false","flattenFolders":"false","preserveTimestamp":"false"},"task":{"id":"5bfb729a-a7c8-4a78-a7c3-8d717bb7c13c","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Azure SQL Publish","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"$(connection)","AuthenticationType":"server","ServerName":"$(sqlservername)","DatabaseName":"$(sqlserverdatabase)","SqlUsername":"$(sqlserverusername)","SqlPassword":"$(sqlserverpassword)","aadSqlUsername":"","aadSqlPassword":"","ConnectionString":"","TaskNameSelector":"DacpacTask","DeploymentAction":"Publish","DacpacFile":"$(dir)/db/SqlServerDatabaseProject.dacpac","BacpacFile":"","SqlFile":"","SqlInline":"","PublishProfile":"","AdditionalArguments":"/p:BlockOnPossibleDataLoss=True /mp:9 /p:IgnoreComments=True /p:DeployDatabaseInSingleUserMode=True /p:VerifyDeployment=True","SqlAdditionalArguments":"","InlineAdditionalArguments":"","IpDetectionMethod":"AutoDetect","StartIpAddress":"","EndIpAddress":"","DeleteFirewallRule":"true"},"task":{"id":"ce85a08b-a538-4d2b-8589-1d37a9ab970f","versionSpec":"1.*","definitionType":"task"}},{"environment":{},"displayName":"AzureBlob File Copy","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"SourcePath":"GeneratedOutputFilesBlob","ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"06db2ffb-9a4e-4822-929f-f4cd52d51177","Destination":"AzureBlob","StorageAccount":"","StorageAccountRM":"maestraldemodbreports","ContainerName":"$(containername)","BlobPrefix":"$(releasenumber)","EnvironmentName":"","EnvironmentNameRM":"","ResourceFilteringMethod":"machineNames","MachineNames":"","vmsAdminUserName":"","vmsAdminPassword":"","TargetPath":"","AdditionalArgumentsForBlobCopy":"","AdditionalArgumentsForVMCopy":"","enableCopyPrerequisites":"false","CopyFilesInParallel":"true","CleanTargetBeforeCopy":"false","skipCACheck":"true","outputStorageUri":"","outputStorageContainerSasToken":""},"task":{"id":"eb72cb01-a7e5-427b-a8a1-1b31ccac8a43","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Edition down for sql server","alwaysRun":false,"continueOnError":false,"condition":"always()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"$(connection)","ScriptType":"FilePath","ScriptPath":"$(System.DefaultWorkingDirectory)/HelpFiles/scripts/boostServerEdition.ps1","Inline":"# You can write your azure powershell scripts inline here. \n# You can also pass predefined and custom variables to this script using arguments","ScriptArguments":"-sqlServerResourceGroupName $(resource-group) -serverName $(short-sqlservername) -databaseName $(sqlserverdatabase) -edition 'Standard' -serviceObjectiveName 'S0'","errorActionPreference":"stop","FailOnStandardError":"false","TargetAzurePs":"OtherVersion","CustomTargetAzurePs":"5.1.1"},"task":{"id":"72a1931b-effb-4d2e-8fd8-f8472a07cb62","versionSpec":"3.*","definitionType":"task"}},{"environment":{},"displayName":"Disable firewall rule copy","alwaysRun":false,"continueOnError":false,"condition":"always()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"$(connection)","ScriptType":"FilePath","ScriptPath":"$(System.DefaultWorkingDirectory)/HelpFiles/scripts/RemoveAzureFirewall.ps1","Inline":"# You can write your azure powershell scripts inline here. \n# You can also pass predefined and custom variables to this script using arguments","ScriptArguments":"-ResourceGroup $(resource-group) -ServerName $(short-sqlservername)","errorActionPreference":"stop","FailOnStandardError":"false","TargetAzurePs":"LatestVersion","CustomTargetAzurePs":"5.1.1"},"task":{"id":"72a1931b-effb-4d2e-8fd8-f8472a07cb62","versionSpec":"3.*","definitionType":"task"}}],"runsOn":["Agent"],"revision":43,"createdBy":{"displayName":"Ratomir Vukadin","id":"33b64992-ef8d-43d2-861b-dfe3dda963b7","uniqueName":"Ratomir@live.com"},"createdOn":"2018-10-27T16:03:45.820Z","modifiedBy":{"displayName":"Ratomir Vukadin","id":"33b64992-ef8d-43d2-861b-dfe3dda963b7","uniqueName":"Ratomir@live.com"},"modifiedOn":"2019-10-08T02:00:20.577Z","comment":"","id":"cee72c1d-e523-4141-98aa-89b7ec69548a","name":"Deployment SQL SSDT package","version":{"major":1,"minor":0,"patch":0,"isTest":false},"iconUrl":"https://cdn.vsassets.io/v/M141_20181024.3/_content/icon-meta-task.png","friendlyName":"Deployment SQL SSDT package","description":"","category":"Deploy","definitionType":"metaTask","author":"Ratomir Vukadin","demands":[],"groups":[],"inputs":[{"aliases":[],"options":{},"properties":{"EndpointFilterRule":"ScopeLevel != AzureMLWorkspace"},"name":"connection","label":"connection","defaultValue":"","required":true,"type":"connectedService:AzureRM","helpMarkDown":"Target Azure Resource Manager subscription for deploying SQL files","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"containername","label":"containername","defaultValue":"","required":true,"type":"string","helpMarkDown":"Name of the Container for uploading the files. If a container with the given name does not exist in the specified storage account, it will automatically be created. <br> If you need to create a virtual directory inside the container, use the blob prefix input below. <br> Example: If your target location is <i>https://myaccount.blob.core.windows.net/mycontainer/vd1/vd2/</i>, then specify <i>mycontainer</i> as container name and <i>vd1/vd2</i> as blob prefix.","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"dir","label":"dir","defaultValue":"$(System.DefaultWorkingDirectory)/Build-DB/artifact","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"releasenumber","label":"releasenumber","defaultValue":"","required":true,"type":"string","helpMarkDown":"Useful for filtering files, for example, append build number to all the blobs to download files from that build only. Example: If you specify blob prefix as <i>myvd1</i>, a virtual directory with this name will be created inside the container. The source files will be copied to <i>https://myaccount.blob.core.windows.net/mycontainer/myvd1/</i>.","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"resource-group","label":"resource-group","defaultValue":"","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"short-sqlservername","label":"short-sqlservername","defaultValue":"","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"sqlserverdatabase","label":"sqlserverdatabase","defaultValue":"$(sqlserverdatabase)","required":true,"type":"string","helpMarkDown":"Database name","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"sqlservername","label":"sqlservername","defaultValue":"$(sqlservername)","required":true,"type":"string","helpMarkDown":"Full URL of the SQL Server","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"sqlserverpassword","label":"sqlserverpassword","defaultValue":"$(sqlserverpassword)","required":true,"type":"string","helpMarkDown":"Password for the Azure SQL Server administrator.<br>It can accept variable defined in build or release pipelines as '$(passwordVariable)'.<br>You may mark the variable type as 'secret' to secure it.","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"sqlserverusername","label":"sqlserverusername","defaultValue":"$(sqlserverusername)","required":true,"type":"string","helpMarkDown":"Specify the Azure SQL Server administrator login.","groupName":""}],"satisfies":[],"sourceDefinitions":[],"dataSourceBindings":[],"instanceNameFormat":"Task group: Deployment SQL SSDT package $(connection)","preJobExecution":{},"execution":{},"postJobExecution":{}}